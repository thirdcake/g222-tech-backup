<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>当事務所のスケジュール - つつじ行政書士事務所</title>
    <meta name="description" content="（毎日更新）今日から2週間分の業務状況を、スケジュールとして表示しています。" />
    <meta property="og:title" content="当事務所のスケジュール - つつじ行政書士事務所" />
    <meta property="og:description" content="（毎日更新）今日から2週間分の業務状況を、スケジュールとして表示しています。" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://g222.tech/img/137/eyecatch.jpg" />
    <meta property="og:site_name" content="つつじ行政書士事務所" />
    <meta property="og:locale" content="ja_JP" />
    <meta property="og:url" content="https://g222.tech/archives/137.html" />
    <link rel="canonical" href="https://g222.tech/archives/137.html" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
                <link rel="stylesheet" href="/assets/bundle.css" />
                <script defer src="/assets/function.js"></script>
    </head>
<body>
    <header>
        <div>
            <div class="site-title">つつじ行政書士事務所</div>
            <nav aria-label="site menu">
                <ul><li>
    <a href="/">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#home"></use>
        </svg>
        <span>ホーム</span>
    </a>
</li>
<li>
    <a href="/archives/">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#archives"></use>
        </svg>
        <span>記事一覧</span>
    </a>
</li>
<li>
    <a href="/contact.html">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#contact"></use>
        </svg>
        <span>お問い合わせ</span>
    </a>
</li>
<li>
    <a href="/about.html">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#about"></use>
        </svg>
        <span>もっと知る</span>
    </a>
</li>
</ul>
            </nav>
        </div>
    </header>
    <main>
        <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="/">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#home"></use>
        </svg>
        <span>ホーム</span>
    </a>
            <span>&nbsp;&gt;&nbsp;</span>
                <a href="/archives/">
            <svg height="16" width="16" viewBox="0 0 16 16">
                <use x="0" y="0" href="/assets/icons.svg#archives"></use>
            </svg>
            <span>記事一覧</span>
        </a>
                    <span>&nbsp;&gt;&nbsp;</span>
                <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#page-fill"></use>
        </svg>
        <span>当事務所のスケジュール</span>
            </nav><div class="eyecatch" style="background-image: url('/img/137/eyecatch.jpg');">
    <details>
        <summary>代替</summary>
        <div>つつじ行政書士事務所のスケジュールです</div>
    </details>
</div>
        <article>
            <h1>当事務所のスケジュール</h1>
            <p class="page-date">
    <span>2023年08月03日作成</span>
        <span>2024年03月20日更新</span>
    </p>
            <div class="content-wrap">
                                <div>
                    <div class="content">
                    <p>今日（<span id="today">0000年00月00日</span>）から2週間分の業務状況をお知らせします。</p>
<h2>業務状況</h2>
<table><caption>〇は新規のご相談可能です。×は対応不可です。</caption><thead><tr><th>日付</th><th>午前</th><th>午後</th></tr></thead><tbody id="calendar"><tr><td>xx日（）</td><td>×</td><td>×</td></tr></tbody></table>
<h2>このスケジュールについて</h2>
<p>上記のスケジュール表は、Google Calendarから、毎日データを自動更新させています。</p>
<p>Google CloudのCalendar APIを使って、自動的にカレンダー情報をホームページに反映させています。</p>
<p>作り方を知りたい方は、ぜひこの後の文章もお読みください。</p>
<h2>スケジュールの作り方</h2>
<p>カレンダー情報をAPIで取得する場合、今回使ったGoogleの他に、<a href="https://learn.microsoft.com/ja-jp/graph/use-the-api">MicrosoftのGraph API</a>もあります。（以前は、TimeTreeというアプリのAPIがあり、日本製で大変使いやすかったようなのですが、2023年12月にサービス終了予定とのことです）</p>
<p>GoogleのCalendar APIについて調べてみると、いろいろ種類があるのですが、今回は、<a href="https://developers.google.com/calendar/api/v3/reference/freebusy/query?hl=ja">freebusy</a>というクエリを利用しました。<br />
カレンダーの時間だけを抽出するので、カレンダーイベントのタイトルや場所等が外部流出する心配もありません。</p>
<p>また、freebusyは、OAuth認証も不要であるため、プログラムも簡単に作れます。<br />
（手打ちのPHPファイルのみで、composerすら利用していません）</p>
<p>なお、セキュリティ上、apiキーや実行ファイルは、公開フォルダの外に置いています。</p>
<h2>この技術でどんなことができるか？</h2>
<p>当サイトの場合、午前・午後の予定だけ分かればよいので、上記のような簡素なスケジュールになりましたが、30分ごとの予定の有無を表示させることも可能です。</p>
<p>freebusyでネット上を探すと、「<a href="https://qiita.com/shigezone/items/7ab266f172590e36bf45">PHPでGoogle Calendar API を使って空き時間を抽出してみた</a>」という記事が見つかります。この例では、30分ごとに予定を調べているようです。</p>
<p>また、calendar apiでOAuth認証を使えば、Google Calendarの情報を取得したり、編集したりもできます。</p>
<p>これを使えば、たとえば、会議室予約システムのようなものが作れると思います。</p>
<p>ただし、認証のプログラムは、ちょっとでも間違えると大変なことになるので、企業向けにプログラムを書いたことがあるプログラマに頼むようにしてください。</p>
<h2>その他の注意点</h2>
<p>Google Cloudを利用するために、Googleにクレジットカード情報を登録する必要があります。<br />
ただし、2023年時点では、無料で利用できています。<br />
（今後、みんなが利用して通信量が増えれば、課金されることになると思います）</p>
<p>当サイトの場合は、レンタルサーバーでcronが使えるため、毎日深夜にcalendar apiから情報を取得し、jsonファイルに出力しています。<br />
このページでは、その静的なjsonファイルを参照するという仕組みにしました。<br />
（この方法ならGoogleへの通信も1日1回で済むので）</p>
<p>このため、最大24時間は予定の反映が遅れる場合があります。ご注意ください。</p>
                    </div>
                </div>
                                <section class="content-aside">
                    <h2>つつじ行政書士事務所</h2>
                    <img src="/favicon.svg" width="60" height="60"
                        style="width:60px;height:auto;display:block;margin:1rem auto;"
                        alt="つつじ行政書士事務所アイコン" />
                    <p>応用情報技術者の行政書士です。<br>ご依頼等は<a href="/contact.html">お問い合わせ</a>からお願いします。</p>
                </section>
            </div>
        </article>
        
<section class="blog-pager">
            <h2>前の記事</h2>
                <div id="post-54" class="content entry-list" style="background-image: linear-gradient(to right, #fff, #fff 50%, rgb(255 255 255 / .7) ), url(/img/54/eyecatch.jpg);" >
    <h2><a href="/archives/54.html">応用情報技術者試験</a></h2>
    <p>情報処理の試験を受験してきました。</p>
    <p><time datetime="2024-02-27">2024年02月27日</time></p>
</div>
                <h2>次の記事</h2>
                <div id="post-223" class="content entry-list" style="background-image: linear-gradient(to right, #fff, #fff 50%, rgb(255 255 255 / .7) ), url(/img/223/eyecatch.jpg);" >
    <h2><a href="/archives/223.html">通信の秘密の法律上の建てつけ</a></h2>
    <p>憲法に規定された「通信の秘密」について、その違法性の判断がブログ記事になっていたので、紹介します。</p>
    <p><time datetime="2024-03-20">2024年03月20日</time></p>
</div>
    </section>
<section class="relation">
    <h2>最近の記事</h2>
    <div id="post-list-position"></div>
</section>
    </main>
    <footer>
        <section>
    <p>最後までお読みいただきありがとうございました。<br>なにかお気づきの点がありましたら、<a href="/contact.html">お問い合わせ</a>ください。</p>
    <p><img class="footer-message-img" src="#" alt="日行連公式キャラクター「ユキマサくん」" decoding="async"
        width="1" height="1" style="display:block;width:300px;height:auto;max-width:100%;" /></p>
    <p>（日行連公式キャラクター「ユキマサくん」）</p>
    <div class="footer-message-text"></div>
</section>
        <section class="footer-menu">
            <h2>メニュー</h2>
            <nav aria-label="footer menu">
                <ul><li>
    <a href="/">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#home"></use>
        </svg>
        <span>ホーム</span>
    </a>
</li>
<li>
    <a href="/archives/">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#archives"></use>
        </svg>
        <span>記事一覧</span>
    </a>
</li>
<li>
    <a href="/contact.html">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#contact"></use>
        </svg>
        <span>お問い合わせ</span>
    </a>
</li>
<li>
    <a href="/about.html">
        <svg height="16" width="16" viewBox="0 0 16 16">
            <use x="0" y="0" href="/assets/icons.svg#about"></use>
        </svg>
        <span>もっと知る</span>
    </a>
</li>
</ul>
            </nav>
        </section>
        <section class="footer-address">
            <h2>つつじ行政書士事務所</h2>
            <address>〒830-0044<br>福岡県久留米市本町233-2-502</address>
            <p style="font-size:.9rem">※ 当事務所は、福岡県久留米市にある行政書士事務所です。<br>群馬県館林市にある、外国人ビザ申請に強い行政書士事務所をお探しの方は、<a href="https://tsutsujiilo.com/">行政書士つつじ国際法務事務所</a>をご覧ください。</p>
        </section>
        
    </footer>
</body>
</html>